{% extends 'base.html' %}
{% load staticfiles %}
{% block page-title %}
<h3>zekoCMR</h3>
{% endblock %}


{% block x_title %}
<h2>Wiadomości</h2>
{% endblock %}

{% block content %}

<div class="container">
    <div class="row">
          <div class="col-sm-3 mail_list_column">
            <button id="compose" class="btn btn-sm btn-success btn-block" type="button" data-toggle="modal" data-target="#writeMessageModal">Wyślij Wiadomość</button>
            {% include 'mssg/send_mssg_modal.html' %}
            {% for mssg in inbox %}
              <div class="mail_list">
                <div class="left">
                  <a data-toggle="modal" href="#" type="button" data-target="#replyMessage{{ mssg.id }}Modal">
                    <i class="fa fa-envelope-o"></i>
                  </a>
                  {% include 'mssg/mssg_reply_modal.html' %}
                  <a data-toggle="modal" data-toggle="tooltip" data-placement="right" title="Usuń" href="#" data-target="#deleteMessage{{ mssg.id }}Modal">
                    <i class="fa fa-trash-o"></i>
                  </a>
                  {% include 'mssg/mssg_del_modal.html' %}
                  <a href="javascript:allertCurrentMssg({{mssg.id}})">js</a>
                </div>
                <a href="?current={{mssg.id}}{% if inbox %}&page={{ inbox.number }}{% endif %}"><!-- here -->
                  <div class="right">
                    <h3>od: <i><b>{{ mssg.mssg_from.username }}</b></i>
                        do: <i><b>{{ mssg.mssg_to.username }}</b></i>
                      <small>{{ mssg.delivery_date }}</small></h3>
                    <h2>{{ mssg.title|safe }}</h2>
                    <p>{{ mssg.text|safe|truncatewords:15 }}</p>
                  </div>
                </a>
              </div>
            {% endfor %}
            <div class="mail_list">
              {% include 'mssg/pagination_inbox.html' with pages=inbox %}
            </div>
          </div>
          <!-- /MAIL LIST -->

          <!-- CONTENT MAIL -->
          <div class="col-sm-9 mail_view">
            <div class="inbox-body">
              <div class="mail_heading row">
                <div class="col-md-8">
                  <div class="btn-group">
                    <button class="btn btn-sm btn-primary" data-toggle="modal" type="button" data-target="#replyMessage{{ current_mssg.id }}Modal">
                      <i class="fa fa-envelope"></i> Odpisz
                    </button>
                    <button class="btn btn-sm btn-default" data-toggle="modal" type="button" data-placement="top" data-toggle="tooltip" data-original-title="Usuń" data-target="#deleteMessage{{ current_mssg.id }}Modal">
                      <i class="fa fa-trash-o"></i>
                    </button>
                  </div>
                </div>
                <div class="col-md-4 text-right">
                  <p class="date">{{ current_mssg.delivery_date }}</p>
                </div>
                <div class="col-md-12">
                  <h4> {{ current_mssg.title|safe }}</h4>
                </div>
              </div>
              <div class="sender-info">
                <div class="row">
                  <div class="col-md-12">
                    <strong>{{ current_mssg.mssg_from.username }}</strong>
                    do
                    <strong>{{ current_mssg.mssg_to.username }}</strong>
                  </div>
                </div>
              </div>
              <div class="view-mail">
                {{ current_mssg.text|linebreaks|safe }}
              </div>
              <div class="btn-group">
                    <button class="btn btn-sm btn-primary" data-toggle="modal" type="button" data-target="#replyMessage{{ current_mssg.id }}Modal">
                      <i class="fa fa-envelope"></i> Odpisz
                    </button>
                    {% include 'mssg/mssg_reply_modal.html' with mssg=current_mssg %}

                    <button class="btn btn-sm btn-default" data-toggle="modal" type="button" data-target="#deleteMessage{{ current_mssg.id }}Modal">
                      <i class="fa fa-trash-o"></i>
                    </button>
                    {% include 'mssg/mssg_del_modal.html' with mssg=current_mssg %}
              </div>
            </div>

          </div>
          <!-- end of mailing content -->
    </div>
</div>
{% endblock %}

{% block script %}
 <script src="{% static "js/main.js" %}"></script>
{% endblock %}
